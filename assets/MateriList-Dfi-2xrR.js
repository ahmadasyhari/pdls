import{A as L,r as i,o as R,a as M,w as s,u as l,Q as C,T as F,S as I,p as m,g as G,b as w,d as v,e as n,B as P,U as j,a2 as z,C as H,v as r,I as K,f as e,V as f,j as U,k as O,F as W,a3 as _,a4 as Q,a5 as y,a6 as J,a7 as p,x as g,l as X,m as Y,$ as S,a8 as Z,a9 as h,aa}from"./index-CmKQmBsg.js";const ea={class:"container"},ta={class:"table-container"},la={class:"materi-table"},na=["src"],sa={class:"form-container"},oa={class:"form-group"},ua={class:"form-group"},ra={class:"form-group"},ia={class:"form-group"},da={__name:"MateriList",setup(ma){const D=i([]),d=i(!1),c=i(!1),b=i(null),x=i(""),k=i(""),u=i({name:"",category:"",rating:"",duration:"",image:""}),T=async()=>{const a=C().currentUser;if(!a)return;x.value=a.uid;const t=await F(I(m,"users",a.uid));t.exists()&&(k.value=t.data().role)},B=o=>k.value==="admin"||k.value==="kontributor"&&o.createdBy===x.value,E=async o=>{try{const a=I(m,"materi",o);await Z(a),alert("Materi berhasil dihapus!"),V()}catch(a){console.error("Gagal menghapus materi:",a)}},N=()=>{u.value={name:"",category:"",rating:"",duration:"",image:""},c.value=!1,b.value=null},$=async()=>{try{const a=C().currentUser;if(c.value&&b.value){const t=I(m,"materi",b.value);await h(t,u.value),alert("Materi berhasil diperbarui!")}else await aa(w(m,"materi"),{...u.value,createdBy:a.uid}),alert("Materi berhasil ditambahkan!");N(),d.value=!1,V()}catch(o){console.error("Gagal simpan materi:",o)}},q=o=>{u.value={name:o.name,category:o.category,rating:o.rating,duration:o.duration,image:o.image},b.value=o.id,c.value=!0,d.value=!0},V=async()=>{const o=await G(w(m,"materi"));D.value=o.docs.map(a=>({id:a.id,...a.data()}))};return R(async()=>{await T(),await V()}),(o,a)=>(v(),M(l(Y),null,{default:s(()=>[n(l(K),null,{default:s(()=>[n(l(P),{color:"primary"},{default:s(()=>[n(l(j),{slot:"start"},{default:s(()=>[n(l(z),{"default-href":"/"})]),_:1}),n(l(H),null,{default:s(()=>a[8]||(a[8]=[r("Data Materi")])),_:1})]),_:1})]),_:1}),n(l(X),{class:"ion-padding bg-gray-100"},{default:s(()=>[e("div",ea,[n(l(f),{expand:"block",onClick:a[0]||(a[0]=t=>d.value=!0),class:"tambah-button"},{default:s(()=>a[9]||(a[9]=[r(" Tambah Materi ")])),_:1}),e("div",ta,[e("table",la,[a[12]||(a[12]=e("thead",null,[e("tr",null,[e("th",null,"Nama"),e("th",null,"Kategori"),e("th",null,"Rating"),e("th",null,"Waktu"),e("th",null,"Gambar"),e("th",null,"Aksi")])],-1)),e("tbody",null,[(v(!0),U(W,null,O(D.value,t=>(v(),U("tr",{key:t.id},[e("td",null,g(t.name),1),e("td",null,g(t.category),1),e("td",null,g(t.rating),1),e("td",null,g(t.duration)+" menit",1),e("td",null,[e("img",{src:t.image,class:"thumb"},null,8,na)]),e("td",null,[B(t)?(v(),M(l(f),{key:0,size:"small",onClick:A=>q(t)},{default:s(()=>a[10]||(a[10]=[r("Edit")])),_:2},1032,["onClick"])):S("",!0),B(t)?(v(),M(l(f),{key:1,size:"small",color:"danger",onClick:A=>E(t.id)},{default:s(()=>a[11]||(a[11]=[r("Hapus")])),_:2},1032,["onClick"])):S("",!0)])]))),128))])])]),n(l(_),{"is-open":d.value,onDidDismiss:a[7]||(a[7]=t=>d.value=!1)},{default:s(()=>[e("div",sa,[e("form",{onSubmit:Q($,["prevent"])},[e("div",oa,[a[13]||(a[13]=e("label",null,"Nama Materi",-1)),n(l(y),{modelValue:u.value.name,"onUpdate:modelValue":a[1]||(a[1]=t=>u.value.name=t),required:"",class:"custom-input"},null,8,["modelValue"])]),n(l(J),{modelValue:u.value.category,"onUpdate:modelValue":a[2]||(a[2]=t=>u.value.category=t),interface:"popover",placeholder:"Pilih Kategori",class:"custom-input"},{default:s(()=>[n(l(p),{value:"Science"},{default:s(()=>a[14]||(a[14]=[r("Science")])),_:1}),n(l(p),{value:"Technology"},{default:s(()=>a[15]||(a[15]=[r("Technology")])),_:1}),n(l(p),{value:"Engineering"},{default:s(()=>a[16]||(a[16]=[r("Engineering")])),_:1}),n(l(p),{value:"Arts"},{default:s(()=>a[17]||(a[17]=[r("Arts")])),_:1}),n(l(p),{value:"Mathematics"},{default:s(()=>a[18]||(a[18]=[r("Mathematics")])),_:1})]),_:1},8,["modelValue"]),e("div",ua,[a[19]||(a[19]=e("label",null,"Rating",-1)),n(l(y),{modelValue:u.value.rating,"onUpdate:modelValue":a[3]||(a[3]=t=>u.value.rating=t),type:"number",step:"0.1",min:"0",max:"5",required:"",class:"custom-input"},null,8,["modelValue"])]),e("div",ra,[a[20]||(a[20]=e("label",null,"Waktu Pengerjaan (menit)",-1)),n(l(y),{modelValue:u.value.duration,"onUpdate:modelValue":a[4]||(a[4]=t=>u.value.duration=t),type:"number",min:"1",required:"",class:"custom-input"},null,8,["modelValue"])]),e("div",ia,[a[21]||(a[21]=e("label",null,"Link Gambar",-1)),n(l(y),{modelValue:u.value.image,"onUpdate:modelValue":a[5]||(a[5]=t=>u.value.image=t),required:"",class:"custom-input"},null,8,["modelValue"])]),n(l(f),{expand:"block",type:"submit",class:"submit-button"},{default:s(()=>[r(g(c.value?"Update Materi":"Simpan ke Firebase"),1)]),_:1}),n(l(f),{expand:"block",color:"danger",type:"button",class:"submit-button",onClick:a[6]||(a[6]=t=>d.value=!1)},{default:s(()=>a[22]||(a[22]=[r(" Close ")])),_:1})],32)])]),_:1},8,["is-open"])])]),_:1})]),_:1}))}},fa=L(da,[["__scopeId","data-v-e92f08cf"]]);export{fa as default};
