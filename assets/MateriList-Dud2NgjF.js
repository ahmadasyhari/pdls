import{A as R,r as i,o as q,a as M,w as n,u as l,Q as C,T as F,S as I,p as m,g as G,b as w,d as v,e as s,B as _,U as z,a1 as H,C as K,v as u,I as O,f as t,V as f,j as S,k as P,F as h,a2 as j,a3 as Q,a4 as V,a5 as J,a6 as c,x as b,l as W,m as X,$ as U,a7 as Y,a8 as Z,a9 as aa}from"./index-Bl1MqZjA.js";const ea={class:"container"},ta={class:"table-container"},la={class:"materi-table"},sa=["src"],na={class:"form-container"},oa={class:"form-group"},ra={class:"form-group"},ua={class:"form-group"},ia={__name:"MateriList",setup(da){const D=i([]),d=i(!1),g=i(!1),p=i(null),x=i(""),y=i(""),r=i({name:"",category:"",rating:"",image:""}),T=async()=>{const a=C().currentUser;if(!a)return;x.value=a.uid;const e=await F(I(m,"users",a.uid));e.exists()&&(y.value=e.data().role)},B=o=>y.value==="admin"||y.value==="kontributor"&&o.createdBy===x.value,E=async o=>{try{const a=I(m,"materi",o);await Y(a),alert("Materi berhasil dihapus!"),k()}catch(a){console.error("Gagal menghapus materi:",a)}},N=()=>{r.value={name:"",category:"",rating:"",image:""},g.value=!1,p.value=null},$=async()=>{try{const a=C().currentUser;if(g.value&&p.value){const e=I(m,"materi",p.value);await Z(e,r.value),alert("Materi berhasil diperbarui!")}else await aa(w(m,"materi"),{...r.value,createdBy:a.uid}),alert("Materi berhasil ditambahkan!");N(),d.value=!1,k()}catch(o){console.error("Gagal simpan materi:",o)}},A=o=>{r.value={name:o.name,category:o.category,rating:o.rating,image:o.image},p.value=o.id,g.value=!0,d.value=!0},k=async()=>{const o=await G(w(m,"materi"));D.value=o.docs.map(a=>({id:a.id,...a.data()}))};return q(async()=>{await T(),await k()}),(o,a)=>(v(),M(l(X),null,{default:n(()=>[s(l(O),null,{default:n(()=>[s(l(_),{color:"primary"},{default:n(()=>[s(l(z),{slot:"start"},{default:n(()=>[s(l(H),{"default-href":"/"})]),_:1}),s(l(K),null,{default:n(()=>a[7]||(a[7]=[u("Data Materi")])),_:1})]),_:1})]),_:1}),s(l(W),{class:"ion-padding bg-gray-100"},{default:n(()=>[t("div",ea,[s(l(f),{expand:"block",onClick:a[0]||(a[0]=e=>d.value=!0),class:"tambah-button"},{default:n(()=>a[8]||(a[8]=[u(" Tambah Materi ")])),_:1}),t("div",ta,[t("table",la,[a[11]||(a[11]=t("thead",null,[t("tr",null,[t("th",null,"Nama"),t("th",null,"Kategori"),t("th",null,"Rating"),t("th",null,"Gambar"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(v(!0),S(h,null,P(D.value,e=>(v(),S("tr",{key:e.id},[t("td",null,b(e.name),1),t("td",null,b(e.category),1),t("td",null,b(e.rating),1),t("td",null,[t("img",{src:e.image,class:"thumb"},null,8,sa)]),t("td",null,[B(e)?(v(),M(l(f),{key:0,size:"small",onClick:L=>A(e)},{default:n(()=>a[9]||(a[9]=[u("Edit")])),_:2},1032,["onClick"])):U("",!0),B(e)?(v(),M(l(f),{key:1,size:"small",color:"danger",onClick:L=>E(e.id)},{default:n(()=>a[10]||(a[10]=[u("Hapus")])),_:2},1032,["onClick"])):U("",!0)])]))),128))])])]),s(l(j),{"is-open":d.value,onDidDismiss:a[6]||(a[6]=e=>d.value=!1)},{default:n(()=>[t("div",na,[t("form",{onSubmit:Q($,["prevent"])},[t("div",oa,[a[12]||(a[12]=t("label",null,"Nama Materi",-1)),s(l(V),{modelValue:r.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>r.value.name=e),required:"",class:"custom-input"},null,8,["modelValue"])]),s(l(J),{modelValue:r.value.category,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value.category=e),interface:"popover",placeholder:"Pilih Kategori",class:"custom-input"},{default:n(()=>[s(l(c),{value:"Science"},{default:n(()=>a[13]||(a[13]=[u("Science")])),_:1}),s(l(c),{value:"Technology"},{default:n(()=>a[14]||(a[14]=[u("Technology")])),_:1}),s(l(c),{value:"Engineering"},{default:n(()=>a[15]||(a[15]=[u("Engineering")])),_:1}),s(l(c),{value:"Arts"},{default:n(()=>a[16]||(a[16]=[u("Arts")])),_:1}),s(l(c),{value:"Mathematics"},{default:n(()=>a[17]||(a[17]=[u("Mathematics")])),_:1})]),_:1},8,["modelValue"]),t("div",ra,[a[18]||(a[18]=t("label",null,"Rating",-1)),s(l(V),{modelValue:r.value.rating,"onUpdate:modelValue":a[3]||(a[3]=e=>r.value.rating=e),type:"number",step:"0.1",min:"0",max:"5",required:"",class:"custom-input"},null,8,["modelValue"])]),t("div",ua,[a[19]||(a[19]=t("label",null,"Link Gambar",-1)),s(l(V),{modelValue:r.value.image,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value.image=e),required:"",class:"custom-input"},null,8,["modelValue"])]),s(l(f),{expand:"block",type:"submit",class:"submit-button"},{default:n(()=>[u(b(g.value?"Update Materi":"Simpan ke Firebase"),1)]),_:1}),s(l(f),{expand:"block",color:"danger",type:"button",class:"submit-button",onClick:a[5]||(a[5]=e=>d.value=!1)},{default:n(()=>a[20]||(a[20]=[u(" Close ")])),_:1})],32)])]),_:1},8,["is-open"])])]),_:1})]),_:1}))}},va=R(ia,[["__scopeId","data-v-4bfc2045"]]);export{va as default};
