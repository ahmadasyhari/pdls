import{A as E,r as i,o as F,a as M,w as n,u as l,R as C,U as G,T as I,p as m,g as _,b as w,d as v,e as s,B as A,V as z,a2 as H,C as K,v as r,I as O,f as t,W as f,j as S,k as P,F as j,a3 as W,a4 as J,a5 as V,a6 as Q,a7 as p,x as b,l as X,m as Y,a0 as T,a8 as Z,a9 as h,aa}from"./index-DZAp6fpH.js";const ea={class:"container"},ta={class:"table-container"},la={class:"materi-table"},sa=["src"],na={class:"form-container"},oa={class:"form-group"},ua={class:"form-group"},ra={class:"form-group"},ia={__name:"MateriList",setup(da){const D=i([]),d=i(!1),g=i(!1),c=i(null),x=i(""),k=i(""),u=i({name:"",category:"",rating:"",image:""}),U=async()=>{const a=C().currentUser;if(!a)return;x.value=a.uid;const e=await G(I(m,"users",a.uid));e.exists()&&(k.value=e.data().role)},B=o=>k.value==="admin"||k.value==="kontributor"&&o.createdBy===x.value,N=async o=>{try{const a=I(m,"materi",o);await Z(a),alert("Materi berhasil dihapus!"),y()}catch(a){console.error("Gagal menghapus materi:",a)}},R=()=>{u.value={name:"",category:"",rating:"",image:""},g.value=!1,c.value=null},L=async()=>{try{const a=C().currentUser;if(g.value&&c.value){const e=I(m,"materi",c.value);await h(e,u.value),alert("Materi berhasil diperbarui!")}else await aa(w(m,"materi"),{...u.value,createdBy:a.uid}),alert("Materi berhasil ditambahkan!");R(),d.value=!1,y()}catch(o){console.error("Gagal simpan materi:",o)}},$=o=>{u.value={name:o.name,category:o.category,rating:o.rating,image:o.image},c.value=o.id,g.value=!0,d.value=!0},y=async()=>{const o=await _(w(m,"materi"));D.value=o.docs.map(a=>({id:a.id,...a.data()}))};return F(async()=>{await U(),await y()}),(o,a)=>(v(),M(l(Y),null,{default:n(()=>[s(l(O),null,{default:n(()=>[s(l(A),{color:"primary"},{default:n(()=>[s(l(z),{slot:"start"},{default:n(()=>[s(l(H),{"default-href":"/"})]),_:1}),s(l(K),null,{default:n(()=>a[7]||(a[7]=[r("Data Materi")])),_:1})]),_:1})]),_:1}),s(l(X),{class:"ion-padding bg-gray-100"},{default:n(()=>[t("div",ea,[s(l(f),{expand:"block",onClick:a[0]||(a[0]=e=>d.value=!0),class:"tambah-button"},{default:n(()=>a[8]||(a[8]=[r(" Tambah Materi ")])),_:1}),t("div",ta,[t("table",la,[a[11]||(a[11]=t("thead",null,[t("tr",null,[t("th",null,"Nama"),t("th",null,"Kategori"),t("th",null,"Rating"),t("th",null,"Gambar"),t("th",null,"Aksi")])],-1)),t("tbody",null,[(v(!0),S(j,null,P(D.value,e=>(v(),S("tr",{key:e.id},[t("td",null,b(e.name),1),t("td",null,b(e.category),1),t("td",null,b(e.rating),1),t("td",null,[t("img",{src:e.image,class:"thumb"},null,8,sa)]),t("td",null,[B(e)?(v(),M(l(f),{key:0,size:"small",onClick:q=>$(e)},{default:n(()=>a[9]||(a[9]=[r("Edit")])),_:2},1032,["onClick"])):T("",!0),B(e)?(v(),M(l(f),{key:1,size:"small",color:"danger",onClick:q=>N(e.id)},{default:n(()=>a[10]||(a[10]=[r("Hapus")])),_:2},1032,["onClick"])):T("",!0)])]))),128))])])]),s(l(W),{"is-open":d.value,onDidDismiss:a[6]||(a[6]=e=>d.value=!1)},{default:n(()=>[t("div",na,[t("form",{onSubmit:J(L,["prevent"])},[t("div",oa,[a[12]||(a[12]=t("label",null,"Nama Materi",-1)),s(l(V),{modelValue:u.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value.name=e),required:"",class:"custom-input"},null,8,["modelValue"])]),s(l(Q),{modelValue:u.value.category,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value.category=e),interface:"popover",placeholder:"Pilih Kategori",class:"custom-input"},{default:n(()=>[s(l(p),{value:"Sains"},{default:n(()=>a[13]||(a[13]=[r("Sains")])),_:1}),s(l(p),{value:"Teknologi"},{default:n(()=>a[14]||(a[14]=[r("Teknologi")])),_:1}),s(l(p),{value:"Teknik"},{default:n(()=>a[15]||(a[15]=[r("Teknik")])),_:1}),s(l(p),{value:"Seni"},{default:n(()=>a[16]||(a[16]=[r("Seni")])),_:1}),s(l(p),{value:"Matematika"},{default:n(()=>a[17]||(a[17]=[r("Matematika")])),_:1})]),_:1},8,["modelValue"]),t("div",ua,[a[18]||(a[18]=t("label",null,"Rating",-1)),s(l(V),{modelValue:u.value.rating,"onUpdate:modelValue":a[3]||(a[3]=e=>u.value.rating=e),type:"number",step:"0.1",min:"0",max:"5",required:"",class:"custom-input"},null,8,["modelValue"])]),t("div",ra,[a[19]||(a[19]=t("label",null,"Link Gambar",-1)),s(l(V),{modelValue:u.value.image,"onUpdate:modelValue":a[4]||(a[4]=e=>u.value.image=e),required:"",class:"custom-input"},null,8,["modelValue"])]),s(l(f),{expand:"block",type:"submit",class:"submit-button"},{default:n(()=>[r(b(g.value?"Update Materi":"Simpan ke Firebase"),1)]),_:1}),s(l(f),{expand:"block",color:"danger",type:"button",class:"submit-button",onClick:a[5]||(a[5]=e=>d.value=!1)},{default:n(()=>a[20]||(a[20]=[r(" Close ")])),_:1})],32)])]),_:1},8,["is-open"])])]),_:1})]),_:1}))}},va=E(ia,[["__scopeId","data-v-c7622306"]]);export{va as default};
